df_miss_rain <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
df_miss_temp <- df_comb %>%
mutate(col_tmax = ifelse(is.na(col_tmax), 69, col_tmax)) %>%
group_by(group = cumsum(c(0, diff(col_tmax) != 0))) %>%
filter(col_tmax == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
decompose_to_tib <- function(col) {
Y <- msts(df_comb[[col]], seasonal.periods=365.25)
dec <- decompose(Y)
df_m_tmax_dec <- tibble(date = df_comb$date,
total = dec[['x']],
seasonal = dec[['seasonal']],
trend = dec[['trend']],
fluctuations = dec[['random']])
return(df_m_tmax_dec)
}
df_m_rain_dec <- decompose_to_tib('cum_mod_rain')
df_c_rain_dec <- decompose_to_tib('cum_col_rain')
df_m_tmax_dec <- decompose_to_tib('m_tmax_r')
df_c_tmax_dec <- decompose_to_tib('cm_tmax_r')
length(df_comb$date)
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
DTWDistance(df_rain$mod_rain, df_rain$col_rain)
ggplot(df_rain) +
geom_line(aes(x=date, y=mod_rain, color='blue')) +
geom_line(aes(x=date, y=col_rain, color='red'))
View(df_comb)
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'cum_mod_rain', 'cum_col_rain')]
DTWDistance(df_rain2$cum_mod_rain, df_rain2$cum_col_rain)
df_rain2 <- df_comb[!is.na(df_comb$col_rain), c('date', 'cum_mod_rain', 'cum_col_rain')]
DTWDistance(df_rain2$cum_mod_rain, df_rain2$cum_col_rain)
ggplot(df_rain2) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red'))
df_comb <- prep_plot(df_modelled, df_ains, 'ainsdale')
df_comb$col_mod_tmax <- ifelse(is.na(df_comb$col_tmax), df_comb$mod_tmax, df_comb$col_tmax)
df_comb$col_mod_tmin <- ifelse(is.na(df_comb$col_tmin), df_comb$mod_tmin, df_comb$col_tmin)
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmax_r = zoo::rollapply(col_mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmin_r = zoo::rollapply(col_mod_tmin, 7, mean, na.rm = TRUE, fill = NA))
df_miss_rain <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
df_miss_temp <- df_comb %>%
mutate(col_tmax = ifelse(is.na(col_tmax), 69, col_tmax)) %>%
group_by(group = cumsum(c(0, diff(col_tmax) != 0))) %>%
filter(col_tmax == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
decompose_to_tib <- function(col) {
Y <- msts(df_comb[[col]], seasonal.periods=365.25)
dec <- decompose(Y)
df_m_tmax_dec <- tibble(date = df_comb$date,
total = dec[['x']],
seasonal = dec[['seasonal']],
trend = dec[['trend']],
fluctuations = dec[['random']])
return(df_m_tmax_dec)
}
df_m_rain_dec <- decompose_to_tib('cum_mod_rain')
df_c_rain_dec <- decompose_to_tib('cum_col_rain')
df_m_tmax_dec <- decompose_to_tib('m_tmax_r')
df_c_tmax_dec <- decompose_to_tib('cm_tmax_r')
df_rain2 <- df_comb[!is.na(df_comb$col_rain), c('date', 'cum_mod_rain', 'cum_col_rain')]
DTWDistance(df_rain2$cum_mod_rain, df_rain2$cum_col_rain)
df_rain2 <- df_comb[!is.na(df_comb$col_rain) & date < as.POSIXct('2012-01-01'), c('date', 'cum_mod_rain', 'cum_col_rain')]
df_comb <- prep_plot(df_modelled, df_ains_rep, 'ainsdale')
df_comb$col_mod_tmax <- ifelse(is.na(df_comb$col_tmax), df_comb$mod_tmax, df_comb$col_tmax)
df_comb$col_mod_tmin <- ifelse(is.na(df_comb$col_tmin), df_comb$mod_tmin, df_comb$col_tmin)
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmax_r = zoo::rollapply(col_mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmin_r = zoo::rollapply(col_mod_tmin, 7, mean, na.rm = TRUE, fill = NA))
df_miss_rain <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
df_miss_temp <- df_comb %>%
mutate(col_tmax = ifelse(is.na(col_tmax), 69, col_tmax)) %>%
group_by(group = cumsum(c(0, diff(col_tmax) != 0))) %>%
filter(col_tmax == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
decompose_to_tib <- function(col) {
Y <- msts(df_comb[[col]], seasonal.periods=365.25)
dec <- decompose(Y)
df_m_tmax_dec <- tibble(date = df_comb$date,
total = dec[['x']],
seasonal = dec[['seasonal']],
trend = dec[['trend']],
fluctuations = dec[['random']])
return(df_m_tmax_dec)
}
df_m_rain_dec <- decompose_to_tib('cum_mod_rain')
df_c_rain_dec <- decompose_to_tib('cum_col_rain')
df_m_tmax_dec <- decompose_to_tib('m_tmax_r')
df_c_tmax_dec <- decompose_to_tib('cm_tmax_r')
df_rain2 <- df_comb[!is.na(df_comb$col_rain), c('date', 'cum_mod_rain', 'cum_col_rain')]
DTWDistance(df_rain2$cum_mod_rain, df_rain2$cum_col_rain)
df_comb <- prep_plot(df_modelled, df_bure, 'bure.marshes')
df_comb$col_mod_tmax <- ifelse(is.na(df_comb$col_tmax), df_comb$mod_tmax, df_comb$col_tmax)
df_comb$col_mod_tmin <- ifelse(is.na(df_comb$col_tmin), df_comb$mod_tmin, df_comb$col_tmin)
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmax_r = zoo::rollapply(col_mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmin_r = zoo::rollapply(col_mod_tmin, 7, mean, na.rm = TRUE, fill = NA))
df_miss_rain <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
df_miss_temp <- df_comb %>%
mutate(col_tmax = ifelse(is.na(col_tmax), 69, col_tmax)) %>%
group_by(group = cumsum(c(0, diff(col_tmax) != 0))) %>%
filter(col_tmax == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
decompose_to_tib <- function(col) {
Y <- msts(df_comb[[col]], seasonal.periods=365.25)
dec <- decompose(Y)
df_m_tmax_dec <- tibble(date = df_comb$date,
total = dec[['x']],
seasonal = dec[['seasonal']],
trend = dec[['trend']],
fluctuations = dec[['random']])
return(df_m_tmax_dec)
}
df_m_rain_dec <- decompose_to_tib('cum_mod_rain')
df_c_rain_dec <- decompose_to_tib('cum_col_rain')
df_m_tmax_dec <- decompose_to_tib('m_tmax_r')
df_c_tmax_dec <- decompose_to_tib('cm_tmax_r')
#####################################
df_rain2 <- df_comb[!is.na(df_comb$col_rain), c('date', 'cum_mod_rain', 'cum_col_rain')]
DTWDistance(df_rain2$cum_mod_rain, df_rain2$cum_col_rain)
df_comb <- prep_plot(df_modelled, df_bb, 'burnham.beeches')
df_comb$col_mod_tmax <- ifelse(is.na(df_comb$col_tmax), df_comb$mod_tmax, df_comb$col_tmax)
df_comb$col_mod_tmin <- ifelse(is.na(df_comb$col_tmin), df_comb$mod_tmin, df_comb$col_tmin)
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmax_r = zoo::rollapply(col_mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmin_r = zoo::rollapply(col_mod_tmin, 7, mean, na.rm = TRUE, fill = NA))
df_miss_rain <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
df_miss_temp <- df_comb %>%
mutate(col_tmax = ifelse(is.na(col_tmax), 69, col_tmax)) %>%
group_by(group = cumsum(c(0, diff(col_tmax) != 0))) %>%
filter(col_tmax == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
decompose_to_tib <- function(col) {
Y <- msts(df_comb[[col]], seasonal.periods=365.25)
dec <- decompose(Y)
df_m_tmax_dec <- tibble(date = df_comb$date,
total = dec[['x']],
seasonal = dec[['seasonal']],
trend = dec[['trend']],
fluctuations = dec[['random']])
return(df_m_tmax_dec)
}
df_m_rain_dec <- decompose_to_tib('cum_mod_rain')
df_c_rain_dec <- decompose_to_tib('cum_col_rain')
df_m_tmax_dec <- decompose_to_tib('m_tmax_r')
df_c_tmax_dec <- decompose_to_tib('cm_tmax_r')
df_rain2 <- df_comb[!is.na(df_comb$col_rain), c('date', 'cum_mod_rain', 'cum_col_rain')]
DTWDistance(df_rain2$cum_mod_rain, df_rain2$cum_col_rain)
rain_norm_f <- max(c(df_rain2$cum_mod_rain, df_rain2$cum_col_rain))
rain_norm_f
rain_norm_f <- max(c(df_rain2$mod_rain, df_rain2$col_rain))
rain_norm_f <- max(c(df_rain2$mod_rain[!is.na(df_rain2$mod_rain)],
df_rain2$col_rain[!is.na(df_rain2$col_rain)]))
rain_norm_f
length(df_comb$date)
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain2$mod_rain[!is.na(df_rain2$mod_rain)],
df_rain2$col_rain[!is.na(df_rain2$col_rain)]))
rain_norm_f
View(df_rain)
rain_norm_f <- max(df_rain2$mod_rain)
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
rain_norm_f
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain2$mod_norm, df_rain2$col_norm)
DTWDistance(df_rain$mod_norm, df_rain2$col_norm)
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_rain/rain_norm_f
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_tmax, df_tmax$col_tmax)
ggplot(df_tmax) +
geom_line(aes(x=date, y=mod_norm, color='blue')) +
geom_line(aes(x=date, y=col_norm, color='red'))
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_ains, 'ainsdale')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_ains_rep, 'ainsdale')
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_comb <- prep_plot(df_modelled, df_ains, 'ainsdale')
df_comb$col_mod_tmax <- ifelse(is.na(df_comb$col_tmax), df_comb$mod_tmax, df_comb$col_tmax)
df_comb$col_mod_tmin <- ifelse(is.na(df_comb$col_tmin), df_comb$mod_tmin, df_comb$col_tmin)
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmax_r = zoo::rollapply(col_mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
cm_tmin_r = zoo::rollapply(col_mod_tmin, 7, mean, na.rm = TRUE, fill = NA))
df_miss_rain <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
df_miss_temp <- df_comb %>%
mutate(col_tmax = ifelse(is.na(col_tmax), 69, col_tmax)) %>%
group_by(group = cumsum(c(0, diff(col_tmax) != 0))) %>%
filter(col_tmax == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
decompose_to_tib <- function(col) {
Y <- msts(df_comb[[col]], seasonal.periods=365.25)
dec <- decompose(Y)
df_m_tmax_dec <- tibble(date = df_comb$date,
total = dec[['x']],
seasonal = dec[['seasonal']],
trend = dec[['trend']],
fluctuations = dec[['random']])
return(df_m_tmax_dec)
}
df_m_rain_dec <- decompose_to_tib('cum_mod_rain')
df_c_rain_dec <- decompose_to_tib('cum_col_rain')
df_m_tmax_dec <- decompose_to_tib('m_tmax_r')
df_c_tmax_dec <- decompose_to_tib('cm_tmax_r')
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_comb <- prep_plot(df_modelled, df_ains_rep, 'ainsdale')
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_comb <- prep_plot(df_modelled, df_bure, 'bure.marshes')
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_comb <- prep_plot(df_modelled, df_ains_rep, 'ainsdale')
df_comb <- prep_plot(df_modelled, df_ains, 'ainsdale')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_ains_rep, 'ainsdale')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_bure, 'bure.marshes')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_bb, 'burnham.beeches')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_burnham_rep, 'burnham.beeches')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_cross, 'cross.fell')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_cross_rep, 'cross.fell')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_ing, 'ingleborough')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_liz, 'the.lizard')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
df_comb <- prep_plot(df_modelled, df_liz_cos, 'the.lizard')
df_rain <- df_comb[!is.na(df_comb$col_rain), c('date', 'mod_rain', 'col_rain')]
length(df_rain$mod_rain)
sum(df_rain$mod_rain > 10)
sum(df_rain$col_rain > 10)
rain_norm_f <- max(c(df_rain$mod_rain, df_rain$col_rain))
df_rain$mod_norm <- df_rain$mod_rain/rain_norm_f
df_rain$col_norm <- df_rain$col_rain/rain_norm_f
DTWDistance(df_rain$mod_norm, df_rain$col_norm)
df_tmax <- df_comb[!is.na(df_comb$col_tmax), c('date', 'mod_tmax', 'col_tmax')]
df_tmin <- df_comb[!is.na(df_comb$col_tmin), c('date', 'mod_tmin', 'col_tmin')]
length(df_tmax$mod_tmax)
temp_norm_f <- max(c(df_tmax$mod_tmax, df_tmax$col_tmax))
df_tmax$mod_norm <- df_tmax$mod_tmax/temp_norm_f
df_tmax$col_norm <- df_tmax$col_tmax/temp_norm_f
DTWDistance(df_tmax$mod_norm, df_tmax$col_norm)
