source('./collate_funcs.R')
data_bb <- '../Data/BurnhamBeeches/'
file_in <- 'LTMN_AWS_Burnham_Beeches_raw_data.xlsx'
df_bb <- from_raw(paste0(data_bb, file_in)) %>%
convert_daily()
View(df_bb)
setwd('C:/Users/kiera/Work/NE_work/Weather/collate_data/')
source('./collate_funcs.R')
data_bb <- '../Data/BurnhamBeeches/'
file_in <- 'LTMN_AWS_Burnham_Beeches_raw_data.xlsx'
df_bb <- from_raw(paste0(data_bb, file_in)) %>%
convert_daily()
View(df_bb)
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
df_comb <- prep_plot(df_modelled, df_bure, 'bure.marshes')
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
df_comb <- prep_plot(df_modelled, df_bb, 'burnham.beeches')
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
df_bb[df_bb$rain_sum > 100, 'rain_sum'] <- 0
df_bb[df_bb$rain_sum > 100, 'rain_sum']
df_bb[df_bb$rain_sum > 100, ]
View(df_bb)
df_bb[df_bb$rain_sum ==0, ]
df_bb[is.na(df_bb$rain_sum), ]
df_bb[df_bb$rain_sum > 1000, ]
df_bb[(!is.na(df_bb$rain_sum)) & (df_bb$rain_sum > 1000), ]
df_bb[(!is.na(df_bb$rain_sum)) & (df_bb$rain_sum > 1000), 'rain_sum'] <- NA
df_comb <- prep_plot(df_modelled, df_bb, 'burnham.beeches')
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
data_rep <- '../Data/Representative/'
rep_csv <- 'csv/'
rep_ex <- 'excel/'
list_files_rep_csv <- list.files(paste0(data_rep, rep_csv))
list_rep_csv = list()
for (ii in 1:length(list_files_rep_csv)) {
file_path <- paste0(data_rep, rep_csv, list_files_rep_csv[ii])
print(file_path)
df <- from_rep(file_path, 'B01')
list_rep_csv[[ii]] <- df
}
list_files_rep_ex <- list.files(paste0(data_rep, rep_ex))
list_rep_ex = list()
for (ii in 1:length(list_files_rep_ex)) {
file_path <- paste0(data_rep, rep_ex, list_files_rep_ex[ii])
print(file_path)
df <- from_rep(file_path, 'B01', excel=TRUE)
list_rep_ex[[ii]] <- df
}
df_representative <- combine_weather_hourly(c(list_rep_ex, list_rep_csv)) %>%
convert_daily()
View(df_representative)
get_rep_site <- function(sitecode) {
list_files_rep_csv <- list.files(paste0(data_rep, rep_csv))
list_rep_csv = list()
for (ii in 1:length(list_files_rep_csv)) {
file_path <- paste0(data_rep, rep_csv, list_files_rep_csv[ii])
print(file_path)
df <- from_rep(file_path, sitecode)
list_rep_csv[[ii]] <- df
}
list_files_rep_ex <- list.files(paste0(data_rep, rep_ex))
list_rep_ex = list()
for (ii in 1:length(list_files_rep_ex)) {
file_path <- paste0(data_rep, rep_ex, list_files_rep_ex[ii])
print(file_path)
df <- from_rep(file_path, sitecode, excel=TRUE)
list_rep_ex[[ii]] <- df
}
df_representative <- combine_weather_hourly(c(list_rep_ex, list_rep_csv)) %>%
convert_daily()
return(df_representative)
}
df_ains_rep <- get_rep_site('B01')
View(df_ains_rep)
df_burnham_rep <- get_rep_site('B03')
df_cross_rep <- get_rep_site('B50')
data_cross <- '../Data/CrossFell/'
data_ceh <- 'CEH/'
cf1 <- 'moorh for NE.CSV'
df_cross1 <- from_cosmos_collate(paste0(data_cross, cf1), 'B50') %>%
convert_daily()
cf2 <- 'MOORH_MAY_2017.xlsx'
df_cross2 <- from_cosmos_month_excel(paste0(data_cross, cf2), 'B50')
cf3 <- 'MOORH_JUN_2017.csv'
df_cross3 <- from_cosmos_month_csv3(paste0(data_cross, cf3), 'B50', date_f = '%d/%m/%Y')
cross_list1 <- list(df_cross1, df_cross2, df_cross3)
# Getting all the data from the months of CEH csv files
list_of_files <- list.files(paste0(data_cross, data_ceh))
list_cross = list()
for (ii in 1:length(list_of_files)) {
file_path <- paste0(data_cross, data_ceh, list_of_files[ii])
df <- from_cosmos_month_csv3(file_path, 'B50')
list_cross[[ii]] <- df
}
# combinng the various months with the rest of the data we have
df_cross <- combine_weather_daily(c(weather_list, list_cross))
View(df_cross)
View(df_cross1)
View(df_cross2)
View(df_cross3)
View(list_cross)
# combinng the various months with the rest of the data we have
df_cross <- combine_weather_daily(c(weather_list, list_cross))
View(df_cross)
View(df_cross1)
View(weather_list)
# combining the various months with the rest of the data we have
df_cross <- combine_weather_daily(c(cross_list1, list_cross))
View(df_cross)
print(colnames(df_modelled)[grep('rain', colnames(df_modelled))])
data_ing <- '../Data/Ingleborough2/'
camp <- 'camp2/'
ing1 <- 'LTMN_AWS_ Data_Ingleborough 05-14.XLSX'
df_ing1 <- from_aws(paste0(data_ing, ing1)) %>%
convert_daily()
ing2 <- 'MO AWS to Aug 2016 - processed weather data 03-15 08-16.CSV'
df_ing2 <- from_aws_processed2(paste0(data_ing, ing2), 'B12') %>%
convert_daily()
individual_list_ing <- list(df_ing1, df_ing2)
list_of_files <- list.files(paste0(data_ing, camp))
list_ing = list()
for (ii in 1:length(list_of_files)) {
file_path <- paste0(data_ing, camp, list_of_files[ii])
df <- from_camp2(file_path, 'B12') %>%
convert_daily()
list_ing[[ii]] <- df
}
df_ing <- combine_weather_daily(c(individual_list_ing, list_ing))
ing1 <- 'LTMN_AWS_ Data_Ingleborough 05-14.XLSX'
df_ing1 <- from_aws(paste0(data_ing, ing1)) %>%
convert_daily()
df_ing1 <- from_aws(paste0(data_ing, ing1))
View(df_ing1)
df_ing1
setwd('C:/Users/kiera/Work/NE_work/Weather/collate_data/')
source('./collate_funcs.R')
ing1 <- 'LTMN_AWS_ Data_Ingleborough 05-14.XLSX'
df_ing1 <- from_aws(paste0(data_ing, ing1)) %>%
convert_daily()
setwd('C:/Users/kiera/Work/NE_work/Weather/collate_data/')
source('./collate_funcs.R')
ing1 <- 'LTMN_AWS_ Data_Ingleborough 05-14.XLSX'
df_ing1 <- from_aws(paste0(data_ing, ing1)) %>%
convert_daily()
setwd('C:/Users/kiera/Work/NE_work/Weather/collate_data/')
source('./collate_funcs.R')
ing1 <- 'LTMN_AWS_ Data_Ingleborough 05-14.XLSX'
df_ing1 <- from_aws(paste0(data_ing, ing1)) %>%
convert_daily()
View(df_ing1)
ing2 <- 'MO AWS to Aug 2016 - processed weather data 03-15 08-16.CSV'
df_ing2 <- from_aws_processed2(paste0(data_ing, ing2), 'B12') %>%
convert_daily()
individual_list_ing <- list(df_ing1, df_ing2)
list_of_files <- list.files(paste0(data_ing, camp))
list_ing = list()
for (ii in 1:length(list_of_files)) {
file_path <- paste0(data_ing, camp, list_of_files[ii])
df <- from_camp2(file_path, 'B12') %>%
convert_daily()
list_ing[[ii]] <- df
}
df_ing <- combine_weather_daily(c(individual_list_ing, list_ing))
setwd('C:/Users/kiera/Work/NE_work/Weather/collate_data/')
source('./collate_funcs.R')
View(df_ing)
print(colnames(df_modelled)[grep('rain', colnames(df_modelled))])
data_liz <- '../Data/Lizard/'
liz1 <- 'LIZ_MO_AWS_version1_and_version0_combined.xlsx'
df_liz1 <- from_aws_processed2(paste0(data_liz, liz1), 'B40', excel=TRUE) %>%
convert_daily()
liz2 <- 'LTMN_AWS_The_Lizard_raw_data.xlsx'
df_liz2 <- from_raw(paste0(data_liz, liz2)) %>%
convert_daily()
df_liz <- combine_weather_daily(list(df_liz1, df_liz2))
sitecode <- 'B40'
cosmos <- 'COSMOS/'
cos_csv <- 'csv/'
cos_ex <- 'excel/'
liz_c1 <- 'COSMOS lizrd for NE.CSV'
df_liz_c1 <- from_cosmos_collate(paste0(data_liz, cosmos, liz_c1), sitecode = 'B40') %>%
convert_daily()
liz_c2 <- 'LIZRD_JUN_2017.csv'
df_liz_c2 <- from_cosmos_month_csv3(paste0(data_liz, cosmos, liz_c2), 'B40', date_f = '%d/%m/%Y')
ind_files_liz <- list(df_liz_c1, df_liz_c2)
list_of_files <- list.files(paste0(data_liz, cosmos, cos_csv))
list_liz = list()
for (ii in 1:length(list_of_files)) {
file_path <- paste0(data_liz, cosmos, cos_csv, list_of_files[ii])
df <- from_cosmos_month_csv3(file_path, 'B12')#
list_liz[[ii]] <- df
}
list_of_files2 <- list.files(paste0(data_liz, cosmos, cos_ex))
list_liz22 = list()
for (ii in 1:length(list_of_files2)) {
file_path <- paste0(data_liz, cosmos, cos_ex, list_of_files2[ii])
df <- from_cosmos_month_excel(file_path, 'B12')
list_liz22[[ii]] <- df
}
df_liz_cos <- combine_weather_daily(c(ind_files_liz, list_liz, list_liz22))
View(df_liz_cos)
df_comb <- prep_plot(df_modelled, df_liz_cos, 'the.lizard')
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=m_tmax_r, color='blue')) +
geom_line(aes(x=date, y=c_tmax_r, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
df_comb <- prep_plot(df_modelled, df_liz, 'the.lizard')
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
liz1 <- 'LIZ_MO_AWS_version1_and_version0_combined.xlsx'
df_liz1 <- from_aws_processed2(paste0(data_liz, liz1), 'B40', excel=TRUE)
View(df_liz1)
setwd('C:/Users/kiera/Work/NE_work/Weather/collate_data/')
source('./collate_funcs.R')
data_liz <- '../Data/Lizard/'
liz1 <- 'LIZ_MO_AWS_version1_and_version0_combined.xlsx'
df_liz1 <- from_aws_processed2(paste0(data_liz, liz1), 'B40', excel=TRUE) %>%
convert_daily()
liz2 <- 'LTMN_AWS_The_Lizard_raw_data.xlsx'
df_liz2 <- from_raw(paste0(data_liz, liz2)) %>%
convert_daily()
df_liz <- combine_weather_daily(list(df_liz1, df_liz2))
View(df_liz)
data_bb <- '../Data/BurnhamBeeches/'
file_in <- 'LTMN_AWS_Burnham_Beeches_raw_data.xlsx'
df_bb <- from_raw(paste0(data_bb, file_in)) %>%
convert_daily()
df_bb[(!is.na(df_bb$rain_sum)) & (df_bb$rain_sum > 1000), 'rain_sum'] <- NA
View(df_bb)
df_comb <- prep_plot(df_modelled, df_liz, 'the.lizard')
df_comb$col_mod_rain <- ifelse(is.na(df_comb$col_rain), df_comb$mod_rain, df_comb$col_rain)
df_comb$cum_mod_rain <- cumsum(df_comb[['mod_rain']])
df_comb$cum_col_rain <- cumsum(df_comb[['col_mod_rain']])
df_comb <- df_comb %>%
dplyr::mutate(m_tmin_r = zoo::rollapply(mod_tmin, 7, mean, na.rm = TRUE, fill = NA),
c_time_r = zoo::rollapply(col_tmin, 7, mean, na.rm = TRUE, fill = NA),
m_tmax_r = zoo::rollapply(mod_tmax, 7, mean, na.rm = TRUE, fill = NA),
c_tmax_r = zoo::rollapply(col_tmax, 7, mean, na.rm = TRUE, fill = NA))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
View(df_comb)
df_comb <- df_comb %>%
mutate(no_rain_data = is.na(col_rain))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_for_plot %>% filter(no_rain_data),
aes(xmin = date, xmax = date + 1, ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(no_rain_data),
aes(xmin = date, xmax = date + 1, ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(no_rain_data),
aes(xmin = date, xmax = date + 1, ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(no_rain_data),
aes(xmin = date, xmax = date, ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(no_rain_data),
aes(xmin = date, xmax = date, ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5,
inherit.aes = FALSE
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(no_rain_data),
aes(xmin = date, xmax = date, ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5,
inherit.aes = FALSE
)# +
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(is.na(col_rain)),
aes(xmin = date, xmax = date, ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(is.na(col_rain)), xmin = date, xmax = date,
aes(ymin = -Inf, ymax = +Inf), fill = "skyblue", alpha = 0.5
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(is.na(col_rain)), ymin = -Inf, ymax = +Inf,
aes(xmin = date, xmax = date), fill = "skyblue", alpha = 0.5
) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(is.na(col_rain)), ymin = -Inf, ymax = +Inf,
aes(xmin = date, xmax = date)) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(
data = df_comb %>% filter(!is.na(col_rain)), ymin = -Inf, ymax = +Inf,
aes(xmin = date, xmax = date), fill = "skyblue", alpha = 0.5) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_react(ymin = -Inf, ymax = +Inf, xmin = df_comb$date[50], xmax = df_comb$date[500])
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_react(ymin = -Inf, ymax = +Inf, xmin = df_comb$date[50], xmax = df_comb$date[500]) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(ymin = -Inf, ymax = +Inf, xmin = df_comb$date[50], xmax = df_comb$date[500]) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
df_miss <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 0, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 1 & n() > 1) %>%
summarize("Start Date"=min(as.character(date)),
"End Date"=max(as.character(date)),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
View(df_miss)
df_miss <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 1) %>%
summarize("Start Date"=min(as.character(date)),
"End Date"=max(as.character(date)),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
View(df_miss)
df_miss <- df_comb %>%
#mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(is.na(col_rain) & n() > 1) %>%
summarize("Start Date"=min(as.character(date)),
"End Date"=max(as.character(date)),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
View(df_miss)
df_miss <- df_comb %>%
#mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(is.na(col_rain) & n() > 1) %>%
summarize("start.date"=min(as.character(date)),
"end.date"=max(as.character(date)),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
View(df_miss)
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(data = df_miss, ymin = -Inf, ymax = +Inf, aes(xmin = start.date, xmax = end.date)) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
df_miss2 <- df_comb %>%
#mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(is.na(col_rain) & n() > 1) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
View(df_miss2)
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(data = df_miss2, ymin = -Inf, ymax = +Inf, aes(xmin = start.date, xmax = end.date)) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
df_miss2 <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 1) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
View(df_miss2)
df_miss2 <- df_comb %>%
mutate(col_rain = ifelse(is.na(col_rain), 69, col_rain)) %>%
group_by(group = cumsum(c(0, diff(col_rain) != 0))) %>%
filter(col_rain == 69 & n() > 10) %>%
summarize("start.date"=min(date),
"end.date"=max(date),
"Length of Run"=n()) %>%
ungroup() %>%
select(-matches("group"))
View(df_miss2)
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(data = df_miss2, ymin = -Inf, ymax = +Inf, aes(xmin = start.date, xmax = end.date)) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(data = df_miss2, ymin = -Inf, ymax = +Inf, aes(xmin = start.date, xmax = end.date)) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(data = df_miss2, ymin = -Inf, ymax = +Inf,
aes(xmin = start.date, xmax = end.date),
color = 'skyblue', alpha = 0.5) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
ggplot(df_comb) +
geom_line(aes(x=date, y=cum_mod_rain, color='blue')) +
geom_line(aes(x=date, y=cum_col_rain, color='red')) +
geom_rect(data = df_miss2, ymin = -Inf, ymax = +Inf,
aes(xmin = start.date, xmax = end.date),
fill = 'skyblue', alpha = 0.5) +
scale_color_discrete(name = "Datasets", labels = c("Modelled", "Collected"))
setwd('C:/Users/kiera/Work/NE_work/Weather/collate_data/')
source('./collate_funcs.R')
df_bb <- from_raw(paste0(data_bb, file_in))
